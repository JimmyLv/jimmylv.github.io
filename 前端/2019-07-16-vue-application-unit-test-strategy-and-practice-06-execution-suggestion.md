---
layout: post
title: 'Vue åº”ç”¨å•å…ƒæµ‹è¯•çš„ç­–ç•¥ä¸å®è·µ 06 - å¦‚ä½•è½åœ°çš„å‡ ç‚¹å»ºè®®'
categories: [å‰ç«¯]
tags: [Tutorial, UnitTest, Team, Vue, Vuex, Jest, CQRS, TDD]
published: True
---

## æœ¬æ–‡çš„ç›®æ ‡

4. åœ¨ Vue é¡¹ç›®ä¸­å¦‚ä½•æ¨åŠ¨æ•´ä¸ªå›¢é˜Ÿå¾ªåºæ¸è¿›åœ°é‡‡å–å•å…ƒæµ‹è¯•ç­–ç•¥ï¼Ÿé€æ­¥æé«˜ä»£ç è´¨é‡å’Œæµ‹è¯•è¦†ç›–ç‡ï¼Ÿ

```md
// Given
ä¸€ä¸ªéœ€è¦åœ¨å›¢é˜Ÿä¸­æ¨è¡Œæµ‹è¯•ç­–ç•¥çš„ Tech LeadğŸ‘¨â€ğŸ’»â€
// When
å½“ä»– ğŸš¶ é˜…è¯»æœ¬æ–‡çš„ Vue åº”ç”¨æµ‹è¯•ç­–ç•¥è½åœ°éƒ¨åˆ†
// Then
ä»–èƒ½å¤Ÿåœ¨å›¢é˜Ÿä¸­å¾ªåºæ¸è¿›åœ°æ¨è¡Œæµ‹è¯•ç­–ç•¥ï¼Œ
ä»–èƒ½å¤Ÿæ‰¾åˆ°å•å…ƒæµ‹è¯•çš„åé¦ˆæœºåˆ¶ï¼Œè¿½æ±‚æŠ€æœ¯å“è¶Š
```

## Vue åº”ç”¨æµ‹è¯•ç­–ç•¥çš„è½åœ°

### 1. åˆ©ç”¨å¥½â€œå•å…ƒæµ‹è¯•æ˜¯ä¸€ç§æ”¿æ²»æ­£ç¡®â€

è°ˆåˆ°å¦‚ä½•æ¨è¿›å•å…ƒæµ‹è¯•çš„è½åœ°ï¼Œé¦–å…ˆå¾—è¦æœ‰ä¸€ä¸ªå¼€å§‹ã€‚å¾ˆå¤šå…¬å¸éƒ½åœ¨æ¨è¡Œ OKRs æˆ–è€… KPI æœºåˆ¶ï¼Œè€ŒæŠ€æœ¯éƒ¨é—¨å¦‚ä½•è¡¡é‡æŠ€æœ¯æ€§çš„ç»©æ•ˆå‘¢ï¼Ÿè¯´å®è¯ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“æŠ€æœ¯ç±»ç»©æ•ˆå…¶å®ä¸å¥½ç”¨æŸäº›æŒ‡æ ‡æ¥è¡¡é‡ï¼Œä½†å¾ˆå¤šæ—¶å€™è€æ¿ä»¬éƒ½ä¼šé“å¬é€”è¯´è§‰å¾—è½¯ä»¶è´¨é‡ç‰¹åˆ«é‡è¦ï¼Œç„¶åå¤§å®¶å¼€å§‹ç”¨æµ‹è¯•è¦†ç›–ç‡æ¥ä½œä¸ºè€ƒæ ¸æ ‡å‡†ï¼Œå…ˆéšä¾¿å®šä¸ªæ•°å§ï¼Œå°± 80% ä¸é”™ã€‚ä½†æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œå“ªæ€• 100% æµ‹è¯•è¦†ç›–ç‡ä¹Ÿæ— æ³•ä¿è¯è½¯ä»¶è´¨é‡ï¼Œç›²ç›®è¿½æ±‚é«˜è¦†ç›–ç‡åè€Œä¼šç‰©æå¿…åå‡ºç°é—®é¢˜ï¼Œæœ€ç»ˆå¯¼è‡´å¤§å®¶ä»¥åå¯¹å•å…ƒæµ‹è¯•ç—›æ¨è‡³æã€‚

ä½†æ­£å› ä¸ºæœ‰äº†è¿™æ ·ä¸€ä¸ªå¼€å§‹çš„å¥‘æœºï¼Œå¤§å®¶æ‰å¼€å§‹æœ‰æ„è¯†æé«˜è½¯ä»¶è´¨é‡ã€‚è€Œä¸”å¤§å®¶æœ€å¼€å§‹éƒ½ä¼šè§‰å¾—â€œå•å…ƒæµ‹è¯•æ˜¯ä¸ªå¥½ä¸œè¥¿â€ï¼Œè®¤å¯å¿«é€Ÿå¼€å‘çš„åŒæ—¶ï¼Œè´¨é‡ä¹Ÿå¾ˆé‡è¦ï¼Œè¿™å°±æ˜¯æˆ‘æ‰€è¯´çš„æ”¿æ²»æ­£ç¡®ã€‚æ—¢ç„¶éƒ½æœ‰äº† OKR çš„æ”¯æŒï¼Œé‚£ä¹ˆä¹Ÿå°±æ„å‘³ç€ï¼Œå…¬å¸å…è®¸å¤§å®¶å­¦ä¹ å•å…ƒæµ‹è¯•å¯èƒ½ä»˜å‡ºçš„æˆæœ¬ï¼ŒæŠ•å…¥äº†æˆæœ¬å½“ç„¶å°±æ„å‘³ç€æ½œåœ¨çš„æ”¶ç›Šã€‚é‚£ä¹ˆå¦‚ä½•å¿«é€Ÿè·å¾—æ”¶ç›Šï¼Œå°±æˆäº†ä¸‹ä¸€ä¸ªè¯é¢˜ã€‚

### 2. è¯±é¥µï¼šä»å¿«é€Ÿè§æ•ˆçš„äº‹æƒ…åšèµ·

å‰æ–‡ä¹Ÿè¯´è¿‡ï¼Œæœ‰äº›åŒå­¦å°±ä¼šåœ¨å¿ƒé‡Œå˜€å’•ï¼šä¸ºäº†è¾¾åˆ°â€œä¿éšœè´¨é‡â€çš„ç›®çš„ï¼Œä¸ä¸€å®šå¾—é€šè¿‡æµ‹è¯•å‘€ï¼Œå°±ç®—éœ€è¦æµ‹è¯•ï¼Œä¹Ÿä¸ä¸€å®šå¾—é€šè¿‡å•å…ƒæµ‹è¯•ã€‚è¿™è¯åœ¨æœ€å¼€å§‹çš„æ—¶å€™ï¼Œç¡®å®æ˜¯å¯¹çš„ï¼Œè°éƒ½æƒ³è·å¾—å¥½å¤„ä¹‹åæ‰èƒ½æ”¾å¿ƒæŠ•å…¥è¿›å»ï¼Œä¸ç„¶é‚£äº›ç½‘ç»œéª—å­ä»¬ä¸ºä»€ä¹ˆæœ€å¼€å§‹æ€»ä¼šç»™ç‚¹å›æŠ¥å½“ä½œè¯±é¥µå‘¢ï¼Ÿæ‰€ä»¥æ ¹æ®æµ‹è¯•å¥–æ¯ ğŸ†ï¼Œ**ä½¿ç”¨é™æ€ç±»å‹ç³»ç»Ÿå’Œ linter** å°±æ˜¯æˆ‘ä»¬æœ€åˆçš„è¯±é¥µï¼ŒESLint èƒ½å¤Ÿæ•è·æ‹¼å†™æˆ–è¯­æ³•ä¹‹ç±»çš„åŸºæœ¬é”™è¯¯ï¼Œå¹¶ä¸”å¤§å¤šæ•°æƒ…å†µä¸‹ ESLint å¾€å¾€éƒ½èƒ½é€šè¿‡ `--fix` è¿›è¡Œè‡ªåŠ¨ä¿®å¤ï¼ˆé…åˆ VSCode/WebStrom æ’ä»¶é£Ÿç”¨æ›´ä½³ï¼‰ã€‚

![](https://pic4.zhimg.com/80/v2-4ebecd1fbcc4274dd531c802f226484b_hd.png)

è¿™ä¸€æ®µæ—¶é—´ï¼Œä¹Ÿå°±æ˜¯å…»æˆä¸€ç§åé¦ˆå›è·¯ï¼Œå³æš—ç¤º-æƒ¯å¸¸è¡Œä¸º-å¥–åŠ±ï¼ˆvia: [ã€Šä¹ æƒ¯çš„åŠ›é‡ã€‹](https://book.douban.com/subject/20507212/)ï¼‰ï¼Œç­‰åˆ°å¤§å®¶éƒ½ä¹ æƒ¯äº†â€œå‡ºç° Lint é”™è¯¯å°±è‡ªåŠ¨ä¿®å¤â€çš„è‡ªåŠ¨åé¦ˆä¹‹åï¼Œä¾¿ä¹Ÿå°±æ˜¯ç¦»ä¸å¼€è¿™ä¸€å¥—è‡ªåŠ¨åŒ–çš„å·¥ä½œæ–¹å¼ã€‚è€Œä¸”åœ¨è¿™ä¸€é˜¶æ®µï¼Œæˆ‘ä»¬ä¸ºæ­¤ä»˜å‡ºçš„æˆæœ¬åŸºæœ¬ä¸º 0ï¼Œæœ€å¼€å§‹ä¹Ÿæ²¡å¿…è¦ä½¿ç”¨æœ€ä¸¥æ ¼çš„ ESLint è§„åˆ™ï¼ˆ[airbnb/javascript: JavaScript Style Guide](https://github.com/airbnb/javascript)ï¼‰ï¼Œå¾ªåºæ¸è¿›å°±å¥½ã€‚

### 3. çœŸæ­£ç†è§£å‰ç«¯æ•°æ®æµçš„å¥½å¤„

å‰æ–‡åœ¨è®²æµ‹è¯•åŸåˆ™çš„æ—¶å€™ä¹Ÿæåˆ°è¿‡å•ä¸€èŒè´£åŸåˆ™ï¼ˆSRPï¼‰ï¼Œå¾ˆå¤šåŒå­¦åœ¨é—ç•™ä»£ç ä¹‹ä¸Šå†™å•å…ƒæµ‹è¯•çš„æ—¶å€™ï¼Œè¡¨ç¤ºç‰¹åˆ«ç—›è‹¦ã€‚â€œè¿™éƒ½æ˜¯äº›å•¥å‘€ï¼Œè¾“å…¥/è¾“å‡ºä¸æ˜ç¡®ï¼Œè¿˜å„ç§å‰¯ä½œç”¨ï¼Œä¸€ä¸ªå‡½æ•°åšäº† 7ã€8 ä»¶äº‹æƒ…ï¼Œä¸€ä¸ªç±»æ‰¿æ‹… 5ã€6 ç§è§’è‰²ã€‚â€æ‰€ä»¥å‘¢ï¼Œè¿™æ—¶å€™æˆ‘ä»¬è¦æ˜ç™½ Vue å’Œ Vuex è¯ç”Ÿçš„èƒŒæ™¯æ˜¯ä»€ä¹ˆï¼Œç†è§£å®ƒä»¬å„è‡ªè¦è§£å†³çš„é—®é¢˜æ˜¯ä»€ä¹ˆã€‚åªæœ‰è§„èŒƒå¥½å„è‡ªçš„èŒè´£ï¼Œæ‰èƒ½å¤ŸæŠŠ UI å’Œæ•°æ®æµæ¸…æ™°å¾—éš”ç¦»å¼€æ¥ã€‚åªæœ‰è¿™æ ·ï¼Œæˆ‘ä»¬ä½œä¸º vuex store çš„ä½¿ç”¨è€…ï¼Œæ‰ä¼šå˜å¾—ç®€å•ï¼Œè€Œä¸åªæ˜¯æŠŠ vuex action å½“æˆä¸€ä¸ª API çš„ç®€å• wrapperï¼Œæ‰€æœ‰æ•°æ®å¤„ç†é€»è¾‘å…¨éƒ¨éƒ½è¿˜æ˜¯æ”¾åœ¨ UI ç»„ä»¶é‡Œé¢ã€‚

**ä»€ä¹ˆæ˜¯æ¶æ„ï¼Œå…¶å®æ¶æ„å°±æ˜¯æŠŠä»£ç æ”¾åˆ°è¯¥æ”¾çš„åœ°æ–¹ã€‚**ä¸å†™ä»£ç çš„æ¶æ„å¸ˆä»¬å½“ç„¶å°±ä¸ä¼šçŸ¥é“ï¼Œä¹Ÿä¸ä¼šçŸ¥é“ä»£ç å†™çƒ‚ä¹‹åï¼Œè¯¥å¦‚ä½•å»è¡¥æµ‹è¯•ã€‚é‚£å¯èƒ½å°±ä¸åªæ˜¯ä¸€ç§â€œè¡¥æµ‹è¯•å°±åƒåƒå‰©é¥­â€çš„æ„Ÿè§‰äº†ï¼Œé‚£åªèƒ½æ˜¯ä¸€ç§åœ¨ä¸æ˜æ’æ³„ç‰©ä¹‹ä¸Šå † ğŸ’© çš„ä½“éªŒã€‚

å†å¤šè¯´ä¸€ä¸‹ Vue ç»„ä»¶æœ¬èº«ï¼Œæˆ‘ä¸€ç›´è§‰å¾— template ç›¸æ¯”äº jsx æ¥è¯´ï¼Œå¾ˆå¤§çš„ä¸€ä¸ªé—®é¢˜å°±æ˜¯ä¸åˆ©äºé‡æ„ï¼Œå³æŠ½å–ç»„ä»¶ã€‚æ»¡å±çš„ `this.xxx` å°±å¥½åƒä¸€ä¸ªæ— æ•Œçš„å±€éƒ¨ global å¯¹è±¡ä¸€æ ·ï¼Œåˆ°å¤„éƒ½èƒ½ç”¨ï¼Œä¹Ÿå°±å¯¼è‡´åˆ°å¤„éƒ½æœ‰å‰¯ä½œç”¨ï¼Œä»è€Œæ ¹æœ¬æ— æ³•æ–¹ä¾¿å¾—æŠ½å– function æˆ–è€…æ”¾å› Vuex storeã€‚

æ‰€ä»¥è¯´ï¼Œåªæœ‰å½“æˆ‘ä»¬**æ­£ç¡®åœ°**ä½¿ç”¨ Vue å’Œ Vuex ä¹‹åï¼Œæ‰èƒ½å¤Ÿä¸ºä¹‹åç¼–å†™å•å…ƒæµ‹è¯•æä¾›è‰¯å¥½çš„åŸºç¡€ã€‚å½“ç„¶ï¼Œè¿™ä¸æ˜¯ç›®çš„ï¼Œå“ªæ€•ä¸å†™å•å…ƒæµ‹è¯•ï¼Œä¹Ÿåº”è¯¥åˆ©ç”¨å¥½å‰ç«¯æ•°æ®æµå¯¹äºä»£ç çš„åˆç†å®‰æ”¾ï¼Œéµå¾ªä¸€å®šçš„åŸåˆ™å°±èƒ½äº«å—è¯¥æœ‰çš„å¥½å¤„ã€‚æˆ‘åªæ˜¯æƒ³å£°æ˜ï¼Œ**å“ªäº›æŠ±æ€¨å•å…ƒæµ‹è¯•éš¾å†™çš„äººï¼Œä¸æ˜¯å› ä¸ºå•å…ƒæµ‹è¯•éš¾å†™ï¼Œè€Œæ˜¯ä½ çš„å®ç°ä»£ç å®åœ¨å¤ªæŒ«ã€‚**

### 4. ä»æ€§ä»·æ¯”æœ€é«˜çš„å•å…ƒæµ‹è¯•å¼€å§‹å†™èµ·

```js
// production code
const computeTotalAmount = (products) => {
  return products.reduce((total, product) => total + product.price, 0)
}

// testing code
it('should return summed up total amount 1000 when there are three products priced 200, 300, 500', () => {
  // given - å‡†å¤‡æ•°æ®
  const products = [
    { name: 'nike', price: 200 },
    { name: 'adidas', price: 300 },
    { name: 'lining', price: 500 },
  ]

  // when - è°ƒç”¨è¢«æµ‹å‡½æ•°
  const result = computeTotalAmount(products)

  // then - æ–­è¨€ç»“æœ
  expect(result).toBe(1000)
})
```

è¿™ä¸ªæµ‹è¯•çš„ä¾‹å­è™½å°ï¼Œä½†äº”è„ä¿±å…¨ã€‚å°±æ˜¯ä¸€ä¸ªæœ€ç®€å•çš„ è¾“å…¥/è¾“å‡º functionï¼Œè¿™å°±æ˜¯æœ€æ–¹ä¾¿æµ‹è¯•çš„åœ°æ–¹ï¼Œä¹Ÿæœ€å…·æµ‹è¯•ä»·å€¼ï¼Œå› ä¸ºè¿™éƒ½æ˜¯æœ€é‡è¦çš„ä¸šåŠ¡æ•°æ®é€»è¾‘ã€‚æƒ³ä¸€æƒ³ä½ çš„ Vue é¡¹ç›®ä¸­å“ªäº›åœ°æ–¹ä¼šæœ‰è¿™æ ·çš„çº¯å‡½æ•°å‘¢ï¼Ÿ

å½“ç„¶å°±æ˜¯ Vuex çš„ mutationã€‚æ‰€ä»¥å½“æˆ‘ä»¬å¼€å§‹æ¨è¡Œå‰ç«¯å•å…ƒæµ‹è¯•çš„æ—¶å€™ï¼Œä¸è¦ä» UI ç»„ä»¶å¼€å§‹ï¼Œè€Œæ˜¯ä» JavaScript å¼€å§‹ï¼Œä»æœ€ç®€å•çš„ function å¼€å§‹ï¼Œéµå¾ªè¿™ä¸ª given-when-then çš„ç»“æ„ï¼Œå¯ä»¥è®©å›¢é˜Ÿå†™å‡ºæ¯”è¾ƒæ¸…æ™°çš„æµ‹è¯•ç»“æ„ã€‚è¿™æ ·çš„å•å…ƒæµ‹è¯•ï¼Œæ—¢æ˜“äºé˜…è¯»ï¼Œä¹Ÿæ˜“äºç¼–å†™ã€‚

æœ€å¤§çš„å¥½å¤„ï¼Œå…¶å®æ˜¯å‡å°‘å­¦ä¹ æˆæœ¬ã€‚å¤§å¤šæ•°å›¢é˜Ÿæˆå‘˜å…¶å®éƒ½æ˜¯ä»æ¨¡ä»¿å¼€å§‹ï¼Œåªæœ‰å•å…ƒæµ‹è¯•æ˜“äºç¼–å†™ï¼Œé‚£ä¹ˆå¤§å®¶æ‰ä¼šæ„¿æ„è·Ÿç€å¼€å§‹å°è¯•å†™ã€‚è€Œæœ€å¼€å§‹çš„é‚£ä»½å•å…ƒæµ‹è¯•ï¼Œä¸€å®šå¾—æ˜¯å†™å¾—æ ‡å‡†çš„ï¼Œå¾—æ˜¯æ˜“äºé˜…è¯»çš„ï¼Œä»è€Œæ‰æ˜¯æ˜“äºæ¨¡ä»¿çš„ã€‚åè¿‡æ¥è¯´ï¼Œæ¨¡ä»¿ï¼Œè¿™ä¹Ÿæ˜¯â€œç ´çª—ç†è®ºâ€ä¹‹æ‰€ä»¥æµè¡Œçš„åŸå› ã€‚

### 5. æµ‹è¯•è¦†ç›–ç‡ï¼šæ¯æ¬¡è¿›æ­¥ä¸€ç‚¹ç‚¹

åªè¦å¤§å®¶å¼€å§‹åŠ¨æ‰‹å†™å•å…ƒæµ‹è¯•ï¼Œå°±æˆåŠŸäº†æœ€éš¾çš„ 50%ï¼Œæ¥ä¸‹æ¥å°±éœ€è¦å¤§å®¶åšæŒä¸‹æ¥ã€‚å€Ÿé‰´äº[ã€Šæ¸¸æˆæ”¹å˜ä¸–ç•Œã€‹](https://book.douban.com/subject/10828002/)è¿™æœ¬ä¹¦ä¸­æ‰€æåˆ°çš„ç†è®ºæ”¯æŒï¼Œæˆ‘ä»¬éœ€è¦ä¸ºå¤§å®¶åˆ›é€ åé¦ˆï¼Œåˆ›é€ æ›´æ»¡æ„çš„å·¥ä½œå’Œæ›´æœ‰æŠŠæ¡çš„æˆåŠŸã€‚

> ç²¾å¿ƒè®¾è®¡çš„æ¸¸æˆå·¥ä½œè®©äººè§‰å¾—æ›´æœ‰ç”Ÿäº§åŠ›ï¼Œå› ä¸ºå®ƒæ„Ÿè§‰èµ·æ¥æ›´çœŸå®ï¼šåé¦ˆæ¥å¾—åˆå¼ºåˆå¿«ï¼Œå½±å“æ˜æ˜¾è€Œç”ŸåŠ¨ã€‚å¯¹å¾ˆå¤šä¸å–œæ¬¢è‡ªå·±çš„æ—¥å¸¸å·¥ä½œã€è§‰å¾—å®ƒæ²¡æœ‰ä»€ä¹ˆç›´æ¥å½±å“çš„äººè€Œè¨€ï¼Œæ¸¸æˆé‡Œçš„å·¥ä½œæä¾›äº†çœŸæ­£çš„å¥–åŠ±å’Œæ»¡è¶³æ„Ÿã€‚

é‚£ä¹ˆï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•ä¸ºå›¢é˜Ÿåˆ›é€ æ¸¸æˆé‡Œæ‰“æ€ªå‡çº§èˆ¬çš„æµ‹è¯•å¼€å‘ä½“éªŒå‘¢ï¼Ÿé¡ºä¾¿æˆ‘ä»¬å¯ä»¥å›ç­”ä¸€ä¸‹ï¼Œè¯¥å¦‚ä½•å¾ªåºæ¸è¿›æå‡é¡¹ç›®å•å…ƒæµ‹è¯•è¦†ç›–ç‡è¿™ä¸ªé—®é¢˜ã€‚

![](https://camo.githubusercontent.com/7992f05135785019d3696e57aca343ee8e376f52/68747470733a2f2f776f756e6465726f2e66696c65732e776f726470726573732e636f6d2f323031332f30322f6536616638666535613461396539383362646536616639346535383938646534623838306535613461396539383062326536616461356534623838306539626239656539626239652e6a7067)

ğŸ‘† ä¸Šå›¾çš„é“ç†æˆ‘ä»¬éƒ½æ˜ç™½ï¼Œå“ªæ€•æ¯å¤©åªè¿›æ­¥ 1%ï¼Œé‚£ä¹ˆä¸€å¹´ 365 å¤©çš„æ•ˆæœä¹Ÿæ˜¯æ— æ¯”éå‡¡çš„ã€‚æˆ‘ä»¬å¯ä»¥ç»™é¡¹ç›®æ·»åŠ ä¸€ä¸ªå•å…ƒæµ‹è¯•è¦†ç›–ç‡æå‡çš„ hookï¼Œå³æ¯æ¬¡ push éƒ½ä¼šæ£€æŸ¥å¹¶æ›´æ–°æµ‹è¯•è¦†ç›–ç‡çš„é˜ˆå€¼ï¼Œæ¯æ¬¡æäº¤éƒ½ä¸èƒ½å°‘äºä¸Šä¸€æ¬¡æäº¤ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æŒç»­è¿›æ­¥ã€æŒç»­æ”¹è¿›ï¼ŒæŒç»­æé«˜æµ‹è¯•è¦†ç›–ç‡å•¦ã€‚

å¹³æ—¶çš„å·¥ä½œæ—¥å¸¸ï¼Œæˆ‘ä»¬è¿˜ä¼šæœ‰ä¸€ä¸ªç”µè§†ä½œä¸º CI Monitorï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠŠå›¢é˜Ÿé¡¹ç›®çš„æµ‹è¯•è¦†ç›–ç‡æ”¾ä¸Šå»ï¼Œæ¯æ¬¡æäº¤ä¹‹åæµ‹è¯•è¦†ç›–ç‡éƒ½ä¼šé«˜ä¸€ç‚¹ç‚¹ï¼Œç»™æ¯ä½åŒå­¦ä¸€ä¸ªå³æ—¶çš„åé¦ˆï¼Œé¼“åŠ±å¤§å®¶åšæŒä¸‹å»ã€‚

å‚è€ƒ [Koleok/jest-coverage-ratchet: Uses jest coverage output to raise acceptable coverage threshold to current coverage](https://github.com/Koleok/jest-coverage-ratchet) é…ç½® jest çš„ coverageReportersï¼š

```js
# jest.config.js
  coverageReporters: [
    "json-summary", "json", "lcov", "text", "clover"
  ],
  coverageThreshold: require('./package.json').jest.coverageThreshold
```

ç„¶åé…ç½® Git hookï¼ŒåŠ åˆ° `prepush` é‡Œé¢è‡ªåŠ¨æ›´æ–° æµ‹è¯•è¦†ç›–ç‡é˜ˆå€¼ã€‚

```json
    "coverage": "lerna run coverage && git add **/package.json && git diff-index --quiet HEAD || git commit -m \"test(unit): update coverage threshold CASABASEA-1246\" --no-verify",
    ...
    "hooks": {
      "commit-msg": "commitlint -E HUSKY_GIT_PARAMS",
      "post-commit": "git update-index --again",
      "pre-commit": "lint-staged",
      "pre-push": "yarn lint && yarn test && yarn coverage"
    }
```

![](https://raw.sevencdn.com/JimmyLv/images/master/2019/20190219135917.png)

### 6. TDDï¼Œæœ€å¥½çš„å†™å•å…ƒæµ‹è¯•çš„æ–¹å¼

![](https://www.objectstyle.com/f/blog_posts/XP-feedback.png)

åœ¨ XP æé™ç¼–ç¨‹æåˆ°çš„åé¦ˆç¯ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œé™¤äº†ç»“å¯¹ç¼–ç¨‹ä»¥å¤–ï¼Œå•å…ƒæµ‹è¯•æ˜¯æˆ‘ä»¬å¼€å‘è€…æœ€å¥½çš„åé¦ˆå·¥å…·ã€‚

æ—¢ç„¶å•å…ƒæµ‹è¯•åº”è¯¥ç”±å¼€å‘è€…ï¼Œåœ¨å¼€å‘è½¯ä»¶çš„åŒæ—¶ç¼–å†™å¯¹åº”çš„å•å…ƒæµ‹è¯•ã€‚å®ƒåº”è¯¥æ˜¯å†…å»ºçš„ï¼Œè€Œä¸æ˜¯åè¡¥çš„ï¼šå³åœ¨ç¼–å†™å®ç°çš„åŒæ—¶å®Œæˆå•å…ƒæµ‹è¯•ï¼Œè€Œä¸æ˜¯å†™å®Œä»£ç å†ä¸€æ¬¡æ€§è¡¥è¶³ã€‚æµ‹è¯•å…ˆè¡Œï¼Œè¿™æ­£æ˜¯ TDDï¼ˆæµ‹è¯•é©±åŠ¨å¼€å‘ï¼‰çš„åšæ³•ã€‚ä½¿ç”¨ TDD å¼€å‘æ–¹æ³•æ˜¯å¾—åˆ°å¯é å•å…ƒæµ‹è¯•çš„å”¯ä¸€é€”å¾„ã€‚

å‰æ–‡æåˆ°æµ‹è¯•å¾ˆéš¾è¡¥ï¼Œå…¶å®è¡¥å‡ºæ¥çš„æµ‹è¯•å‡ ä¹ä¸å¯èƒ½å®Œæ•´è¦†ç›–æˆ‘ä»¬å¯¹é‡æ„å’Œè´¨é‡çš„è¦æ±‚ã€‚TDD å’Œå•å…ƒæµ‹è¯•æ˜¯å…¨æœ‰æˆ–å…¨æ— ï¼šä¸åš TDDï¼Œéš¾ä»¥å¾—åˆ°å¥½çš„å•å…ƒæµ‹è¯•ï¼›TDD æ˜¯è·å¾—å¯é çš„å•å…ƒæµ‹è¯•çš„çš„å”¯ä¸€é€”å¾„ã€‚é™¤æ­¤ä¹‹å¤–åˆ«æ— æ·å¾„ï¼Œæƒ³æŠ›å¼€ TDD è€Œè·å¾—ä¸€ä¸ªå¥½çš„å•å…ƒæµ‹è¯•æ˜¯è¿·æ€ï¼Œéš¾ä»¥æˆåŠŸã€‚

TDDï¼ˆæµ‹è¯•é©±åŠ¨å¼€å‘ï¼‰çš„æ­¥éª¤å¦‚ä¸‹ï¼Œèƒ½å¤Ÿæ—¶åˆ»ç»™äºˆå¼€å‘è€…åé¦ˆï¼Œä»è€ŒåšæŒä¸‹å»ï¼š

- æ²¡æœ‰å•å…ƒæµ‹è¯•ï¼Œä¸å®ç°ä»»ä½•åŠŸèƒ½ä»£ç ï¼›
- åªç¼–å†™ä»…èƒ½ä»£è¡¨ä¸€ç§å¤±è´¥æƒ…å†µçš„æµ‹è¯•ä»£ç ï¼›
- åªç¼–å†™æ°å¥½èƒ½é€šè¿‡å•å…ƒæµ‹è¯•çš„äº§å“ä»£ç ã€‚

![](https://i2.wp.com/blog.knoldus.com/wp-content/uploads/2018/12/tdd.jpg?fit=810%2C479&ssl=1)

## å¯å–œå¯è´ºï¼Œå…¨æ–‡å®Œã€‚

å°±æˆ‘è‡ªå·±è€Œè¨€ï¼Œå†™è¿™ç¯‡æ–‡ç« çš„åŒæ—¶ï¼Œæˆ‘ä¹Ÿåœ¨å›¢é˜Ÿä¸­æ¨è¡Œ Vue å•å…ƒæµ‹è¯•çš„è½åœ°ï¼Œä¸æ­¤åŒæ—¶ä¹Ÿå°è¯•äº† Snapshot Testing å¿«ç…§æµ‹è¯•ã€Storybook ç»„ä»¶åŒ–æµ‹è¯•ã€ä½¿ç”¨ Cypress åš E2E çš„ UI æµ‹è¯•ç­‰ç­‰ã€‚åªèƒ½è¯´ï¼Œè¿™è¿‡ç¨‹å¹¶æ²¡æœ‰æƒ³è±¡ä¸­çš„é‚£ä¹ˆå®¹æ˜“ï¼Œè´¨ç–‘ã€åŸ‹æ€¨ã€å«è‹¦çš„å£°éŸ³æºæºä¸æ–­ï¼Œä½†æ¯å½“åªè¦æœ‰ä¸€ä½åŒå­¦è¯´ä¸Šä¸€å¥â€œæˆ‘å¥½åƒä½“ä¼šåˆ°å†™æµ‹è¯•çš„å¥½å¤„äº†â€ï¼Œâ€œè¿™æ ·å†™ï¼Œå®ç°ä»£ç éƒ½å˜å¾—å¾ˆæ¸…æ™°äº†â€ï¼Œå“ªæ€•åªæœ‰ä¸€ä½ï¼Œé‚£ä¹Ÿå°±è¶³å¤Ÿäº†ã€‚

é“ä¸åŒä¸ç›¸ä¸ºè°‹ï¼Œå‰é€”èŒ«èŒ«ï¼ŒæŠ€æœ¯å“è¶Šä¹‹è·¯è‰°ä¸”é™©ï¼Œä¸å›å…±å‹‰ã€‚

**\## å•å…ƒæµ‹è¯•åŸºç¡€**

- [x] \### å•å…ƒæµ‹è¯•ä¸è‡ªåŠ¨åŒ–çš„æ„ä¹‰
- [x] \### ä¸ºä»€ä¹ˆé€‰æ‹© Jest
- [x] \### Jest çš„åŸºæœ¬ç”¨æ³•
- [x] \### è¯¥å¦‚ä½•æµ‹è¯•å¼‚æ­¥ä»£ç ï¼Ÿ

**\## Vue å•å…ƒæµ‹è¯•**

- [x] \### Vue ç»„ä»¶çš„æ¸²æŸ“æ–¹å¼
- [x] \### Wrapper `find()` æ–¹æ³•ä¸é€‰æ‹©å™¨
- [x] \### UI ç»„ä»¶äº¤äº’è¡Œä¸ºçš„æµ‹è¯•

**\## Vuex å•å…ƒæµ‹è¯•**

- [x] \### CQRS ä¸ `Redux-like` æ¶æ„
- [x] \### å¦‚ä½•å¯¹ Vuex è¿›è¡Œå•å…ƒæµ‹è¯•
- [x] \### Vue ç»„ä»¶å’Œ Vuex store çš„äº¤äº’

**\## Vue åº”ç”¨æµ‹è¯•ç­–ç•¥**

- [x] \### å•å…ƒæµ‹è¯•çš„ç‰¹ç‚¹åŠå…¶ä½ç½®
- [x] \### æµ‹è¯•å¥–æ¯ ğŸ†ï¼šè½¯ä»¶æµ‹è¯•çš„åˆ†å±‚ç­–ç•¥
- [x] \### å•å…ƒæµ‹è¯•çš„ F.I.R.S.T åŸåˆ™

**\## Vue å•å…ƒæµ‹è¯•çš„è½åœ°**

- [x] \### åº”ç”¨æµ‹è¯•ç­–ç•¥è½åœ°çš„å‡ ç‚¹å»ºè®®

## å‚è€ƒèµ„æ–™

> æœ¬æ–‡æ˜¯[ã€è‰ç¨¿ã€‘React åº”ç”¨å•å…ƒæµ‹è¯•ç­–ç•¥](https://github.com/linesh-simplicity/linesh-simplicity.github.io/issues/200)çš„å§Šå¦¹ç¯‡ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸¤ä¸ªåŸå› ï¼š1. ä¸Šæ¬¡åœ¨ FCC ç¤¾åŒºè®² TDD çš„æ—¶å€™è¯´è¿‡å•å…ƒæµ‹è¯•çš„éƒ¨åˆ†å¤ªå¹²ä¸é€‚åˆè®²ï¼Œè€Œæ˜¯æ›´é€‚åˆå†™æˆåšå®¢æ–‡ç« ä½œä¸ºæŠ€æœ¯å‚è€ƒï¼›2. å…¬å¸å†…éƒ¨å·²å…¨çº¿ä½¿ç”¨ Vue æŠ€æœ¯æ ˆä½œä¸ºäº§å“å¼€å‘çš„å‰ç«¯æ¡†æ¶ï¼Œè€Œå•å…ƒæµ‹è¯•å´å› å‘¨æœŸè¾ƒç´§è€Œä¸å¾—å·²æš‚ä¸”æç½®ã€‚

- ç‰¹åˆ«é¸£è°¢ï¼š[React å•å…ƒæµ‹è¯•ç­–ç•¥åŠè½åœ° - ğŸ‘ğŸ‘Linesh çš„åšå®¢ ğŸ‘ğŸ‘](https://blog.linesh.tw/#/post/2018-07-13-react-unit-testing-strategy)
- [ã€ŒæŠ€æœ¯é›·è¾¾ã€ä¹‹ä½¿ç”¨ Enzyme æµ‹è¯• Reactï¼ˆNativeï¼‰ç»„ä»¶](https://blog.jimmylv.info/2016-12-07-react-testing-with-enzyme/)
- [ã€è¯‘ã€‘ä»€ä¹ˆæ˜¯ Flux æ¶æ„ï¼Ÿï¼ˆå…¼è°ˆ DDD å’Œ CQRSï¼‰](https://blog.jimmylv.info/2016-07-07-what-the-flux-on-flux-ddd-and-cqrs/)
- [ã€è¯‘ã€‘æ•´æ´ä»£ç ï¼šJavaScript å½“ä¸­çš„é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™ï¼ˆS.O.L.I.Dï¼‰](https://blog.jimmylv.info/2017-01-08-clean-code-javascript-classes-design-principles/)
- [Testing JavaScript with Kent C. Dodds](https://testingjavascript.com/)
